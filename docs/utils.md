# utils.py

ä¿¡å·è§£æãƒ»å‰å‡¦ç†ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿æ›¸ããªã©ã€æ±ç”¨çš„ã«ä½¿ãˆã‚‹é–¢æ•°ç¾¤ã€‚

---

## ğŸ“Œ é–¢æ•°ä¸€è¦§

### ğŸ” ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ»é…åˆ—æ“ä½œ

- **`get_ind(array, values)`**  
  æœ€è¿‘å‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é«˜é€Ÿã«æ¤œç´¢ã€‚

- **`get_subarray_1D(x, xi, xf)`**  
  1æ¬¡å…ƒé…åˆ—ã‹ã‚‰ç¯„å›²ã‚’åˆ‡ã‚Šå‡ºã™ã€‚

- **`get_subarray_2D(x, y, xi, xf)`**  
  2ç³»åˆ—ã‹ã‚‰ç¯„å›²æŒ‡å®šã§åˆ‡ã‚Šå‡ºã—ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚è¿”ã›ã‚‹ï¼‰ã€‚

- **`get_ind_max_xi_xf(x, y, xi, xf)`**  
  æŒ‡å®šç¯„å›²å†…ã§ `y` ã®æœ€å¤§å€¤ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—ã€‚

- **`get_ind_xi_xf(v, x, y, xi, xf)`**  
  æŒ‡å®šç¯„å›²ã§ `y` ãŒ `v` ã«æœ€ã‚‚è¿‘ã„ä½ç½®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿”ã™ã€‚

- **`get_inds_peak_xi_xf(v, x, y, xi, xf)`**  
  æŒ‡å®šç¯„å›²ã§ãƒ”ãƒ¼ã‚¯ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿”ã™ï¼ˆ`find_peaks` ä½¿ç”¨ï¼‰ã€‚

---

### âš™ ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°

- **`fitting_w_range(fit, x, y, xi, xf, p0, bounds)`**  
  ä»»æ„ã®ç¯„å›²ã«åˆ¶é™ã—ã¦é–¢æ•°ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã€‚  
  `return_x`, `return_pcov` ã«ã‚ˆã‚Šæˆ»ã‚Šå€¤ã‚’åˆ¶å¾¡å¯èƒ½ã€‚

```python
from pyana import fitting_w_range, func
popt = fitting_w_range(func.gaussian_fwhm, x, y, xi=0.1, xf=0.5, p0=[1.0, 0.3, 0.1])
```

---

### ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ« I/O

- **`ndarray_from_txtfile(path, manner)`**  
  åŒºåˆ‡ã‚Šæ–‡å­—æŒ‡å®šã§ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ 2åˆ—èª­ã¿è¾¼ã¿ã€‚

- **`ndarray_from_csvfile(path)`**  
  2åˆ—CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ NumPy é…åˆ—ã‚’èª­ã¿è¾¼ã‚€ã€‚

- **`pickle_dump(obj, path)`**  
  ä»»æ„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ pickle å½¢å¼ã§ä¿å­˜ã€‚

- **`pickle_load(path)`**  
  pickle ãƒã‚¤ãƒŠãƒªã‚’èª­ã¿è¾¼ã¿ã€å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¾©å…ƒã€‚

```python
from pyana import pickle_dump, pickle_load
pickle_dump(data, "backup.pkl")
restored = pickle_load("backup.pkl")
```

---

## ğŸ”§ å‚™è€ƒ

- `get_ind`, `get_subarray_2D`, `fitting_w_range` ãªã©ã¯ã€`SignalData` ã‚¯ãƒ©ã‚¹ã®è£œåŠ©ã¨ã—ã¦ä½¿ã†ã“ã¨ãŒå¤šã„ã§ã™ã€‚
- `curve_fit` ãƒ™ãƒ¼ã‚¹ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ã¯åˆæœŸå€¤ `p0` ã®æŒ‡å®šãŒé‡è¦ã§ã™ã€‚
