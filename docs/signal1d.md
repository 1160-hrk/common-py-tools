# signal1d.py

## ğŸ“ˆ SignalData ã‚¯ãƒ©ã‚¹

`SignalData` ã¯ã€1æ¬¡å…ƒã®ä¿¡å·ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç”¨ã„ãŸé¸æŠå‡¦ç†ã‚„ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ãƒ»å¤‰æ›ãƒ»å¹³æ»‘åŒ–ãªã©ã®è§£æã‚’ç°¡å˜ã«è¡Œã†ãŸã‚ã®ã‚¯ãƒ©ã‚¹ã§ã™ã€‚

---

## ğŸ§± åˆæœŸåŒ–

```python
SignalData(x: np.ndarray, y: np.ndarray)
```

- `x`: æ¨ªè»¸ï¼ˆæ™‚é–“ã€æ³¢æ•°ã€å‘¨æ³¢æ•°ãªã©ï¼‰
- `y`: ä¿¡å·ãƒ‡ãƒ¼ã‚¿

---

## ğŸ”§ åŸºæœ¬æ©Ÿèƒ½

### `set_cursors(a, b)`
ã‚«ãƒ¼ã‚½ãƒ« A, B ã‚’è¨­å®šã—ã€ç¯„å›²é¸æŠã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

---

## ğŸ¯ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ“ä½œ

### `get_segment()`
ç¾åœ¨è¨­å®šã•ã‚ŒãŸã‚«ãƒ¼ã‚½ãƒ«ç¯„å›²ã«å«ã¾ã‚Œã‚‹ `(x, y)` ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã—ã¾ã™ã€‚

---

## ğŸ“Š å¯è¦–åŒ–

### `plot(ax=None)`
ã‚«ãƒ¼ã‚½ãƒ«ç·šã‚’å«ã‚€ç°¡æ˜“çš„ãªä¿¡å·ãƒ—ãƒ­ãƒƒãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

---

## ğŸ§® è§£æç³»ãƒ¡ã‚½ãƒƒãƒ‰

### `fit_segment(func, p0=None, bounds=(-inf, inf), return_curve=False)`
ã‚«ãƒ¼ã‚½ãƒ«å†…ã®ãƒ‡ãƒ¼ã‚¿ã«ä»»æ„ã®é–¢æ•°ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã„ã¾ã™ã€‚

- `func`: ãƒ•ã‚£ãƒƒãƒˆé–¢æ•°ï¼ˆä¾‹ï¼š`gaussian`, `voigt` ãªã©ï¼‰
- `p0`: åˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- `return_curve=True` ã§ãƒ•ã‚£ãƒƒãƒˆçµæœã‚‚è¿”ã—ã¾ã™ã€‚

---

### `fft_segment()`
ã‚«ãƒ¼ã‚½ãƒ«ç¯„å›²ã®ä¿¡å·ã«å¯¾ã—ã¦ FFT ã‚’è¡Œã„ã€`(freq, fft_y)` ã‚’è¿”ã—ã¾ã™ã€‚

---

### `find_extrema_segment()`
æœ€å¤§ãƒ»æœ€å°å€¤ãŠã‚ˆã³ãã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨åº§æ¨™ã‚’è¿”ã—ã¾ã™ï¼ˆè¾æ›¸å½¢å¼ï¼‰ã€‚

---

### `find_peaks_segment(**kwargs)`
ã‚«ãƒ¼ã‚½ãƒ«ç¯„å›²å†…ã®ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã‚’è¡Œã„ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚

---

### `integrate_segment(method='simpson')`
ã‚«ãƒ¼ã‚½ãƒ«å†…ã®ä¿¡å·ã‚’ç©åˆ†ã—ã¾ã™ï¼ˆSimpson ã¾ãŸã¯ Trapezoidalï¼‰ã€‚

---

### `detrend_segment(inplace=False)`
ç·šå½¢ãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆå‚¾ãï¼‰ã‚’é™¤å»ã€‚`inplace=True` ã§å…ƒãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãå¯èƒ½ã€‚

---

### `baseline_subtract_segment(method='mean' or 'custom', value=None)`
ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’é™¤å»ï¼ˆå¹³å‡ã¾ãŸã¯æŒ‡å®šå€¤ï¼‰ã€‚

---

### `smooth_segment(mode='moving_average' or 'savgol', window_size=5, polyorder=2)`
ç§»å‹•å¹³å‡ã¾ãŸã¯ Savitzky-Golay ã«ã‚ˆã‚‹å¹³æ»‘åŒ–ã€‚

---

### `resample_segment(num=None, step=None, method='linear')`
ã‚«ãƒ¼ã‚½ãƒ«å†…ãƒ‡ãƒ¼ã‚¿ã‚’ç­‰é–“éš”ã§å†è£œé–“ã—ã¾ã™ã€‚

- `num`: å‡ºåŠ›ç‚¹æ•°
- `step`: xè»¸ã‚¹ãƒ†ãƒƒãƒ—å¹…
- `method`: `'linear'`, `'cubic'`, `'quadratic'` ãªã©

---

## ğŸ’¾ ãƒ‡ãƒ¼ã‚¿å…¥å‡ºåŠ›

### `to_csv(path)`
x, y ã®ä¿¡å·ãƒ‡ãƒ¼ã‚¿ã‚’ CSV ã«ä¿å­˜ã—ã¾ã™ã€‚

### `from_csv(path)`
CSV ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ `SignalData` ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

---

## âœ… ä½¿ç”¨ä¾‹

```python
from pyana.signal1d import SignalData
from pyana.func import gaussian

x = np.linspace(0, 10, 100)
y = gaussian(x, A=1, x0=5, sigma=1)

data = SignalData(x, y)
data.set_cursors(3, 7)
popt = data.fit_segment(gaussian, p0=[1, 5, 1])
```
